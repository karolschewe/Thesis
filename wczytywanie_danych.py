from import_files import get_data
from datetime import datetime
from collections import Counter

startTime = datetime.now() #mierzenie czasu wykonywania programu

folder = "C:\\Users\\Carlito\\Desktop\\dane" #sciezka do folderu z danymi
data = {"currentMeasurements": {"pm1": 79.747814, "pm10": 157.4844, "pressure": 101980.02606464844, "pm25": 104.02725000000001, "airQualityIndex": 97.28511363636365, "pollutionLevel": 5}, "longitude": 19.998804, "forecast": [{"tillDateTime": "2018-11-08T03:59:59Z", "fromDateTime": "2018-11-08T03:00:00Z", "measurements": {"pollutionLevel": 5, "pm25": 97.35700988769531, "airQualityIndex": 94.25318631258878}}, {"tillDateTime": "2018-11-08T04:59:59Z", "fromDateTime": "2018-11-08T04:00:00Z", "measurements": {"pollutionLevel": 5, "pm25": 89.66079711914062, "airQualityIndex": 90.75490778142756}}, {"tillDateTime": "2018-11-08T05:59:59Z", "fromDateTime": "2018-11-08T05:00:00Z", "measurements": {"pollutionLevel": 5, "pm25": 84.26546478271484, "airQualityIndex": 88.30248399214311}}, {"tillDateTime": "2018-11-08T06:59:59Z", "fromDateTime": "2018-11-08T06:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 80.20223236083984, "airQualityIndex": 86.45556016401811}}, {"tillDateTime": "2018-11-08T07:59:59Z", "fromDateTime": "2018-11-08T07:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 77.6117172241211, "airQualityIndex": 85.2780532836914}}, {"tillDateTime": "2018-11-08T08:59:59Z", "fromDateTime": "2018-11-08T08:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 75.46195220947266, "airQualityIndex": 84.30088736794212}}, {"tillDateTime": "2018-11-08T09:59:59Z", "fromDateTime": "2018-11-08T09:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 71.59577941894531, "airQualityIndex": 82.5435360995206}}, {"tillDateTime": "2018-11-08T10:59:59Z", "fromDateTime": "2018-11-08T10:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 66.02345275878906, "airQualityIndex": 80.01066034490412}}, {"tillDateTime": "2018-11-08T11:59:59Z", "fromDateTime": "2018-11-08T11:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 60.070430755615234, "airQualityIndex": 77.30474125255238}}, {"tillDateTime": "2018-11-08T12:59:59Z", "fromDateTime": "2018-11-08T12:00:00Z", "measurements": {"pollutionLevel": 3, "pm25": 54.671600341796875, "airQualityIndex": 74.67160034179688}}, {"tillDateTime": "2018-11-08T13:59:59Z", "fromDateTime": "2018-11-08T13:00:00Z", "measurements": {"pollutionLevel": 3, "pm25": 51.5089111328125, "airQualityIndex": 71.5089111328125}}, {"tillDateTime": "2018-11-08T14:59:59Z", "fromDateTime": "2018-11-08T14:00:00Z", "measurements": {"pollutionLevel": 3, "pm25": 50.524208068847656, "airQualityIndex": 70.52420806884766}}, {"tillDateTime": "2018-11-08T15:59:59Z", "fromDateTime": "2018-11-08T15:00:00Z", "measurements": {"pollutionLevel": 3, "pm25": 51.39147186279297, "airQualityIndex": 71.39147186279297}}, {"tillDateTime": "2018-11-08T16:59:59Z", "fromDateTime": "2018-11-08T16:00:00Z", "measurements": {"pollutionLevel": 3, "pm25": 54.723731994628906, "airQualityIndex": 74.7237319946289}}, {"tillDateTime": "2018-11-08T17:59:59Z", "fromDateTime": "2018-11-08T17:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 59.69438171386719, "airQualityIndex": 77.13380986993963}}, {"tillDateTime": "2018-11-08T18:59:59Z", "fromDateTime": "2018-11-08T18:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 66.49200439453125, "airQualityIndex": 80.22363836115056}}, {"tillDateTime": "2018-11-08T19:59:59Z", "fromDateTime": "2018-11-08T19:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 74.13040924072266, "airQualityIndex": 83.69564056396484}}, {"tillDateTime": "2018-11-08T20:59:59Z", "fromDateTime": "2018-11-08T20:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 80.11749267578125, "airQualityIndex": 86.41704212535511}}, {"tillDateTime": "2018-11-08T21:59:59Z", "fromDateTime": "2018-11-08T21:00:00Z", "measurements": {"pollutionLevel": 5, "pm25": 83.70120239257812, "airQualityIndex": 88.04600108753552}}, {"tillDateTime": "2018-11-08T22:59:59Z", "fromDateTime": "2018-11-08T22:00:00Z", "measurements": {"pollutionLevel": 5, "pm25": 84.46832275390625, "airQualityIndex": 88.39469216086647}}, {"tillDateTime": "2018-11-08T23:59:59Z", "fromDateTime": "2018-11-08T23:00:00Z", "measurements": {"pollutionLevel": 5, "pm25": 83.43934631347656, "airQualityIndex": 87.9269755970348}}, {"tillDateTime": "2018-11-09T00:59:59Z", "fromDateTime": "2018-11-09T00:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 81.66546630859375, "airQualityIndex": 87.12066650390625}}, {"tillDateTime": "2018-11-09T01:59:59Z", "fromDateTime": "2018-11-09T01:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 80.17768096923828, "airQualityIndex": 86.44440044056286}}, {"tillDateTime": "2018-11-09T02:59:59Z", "fromDateTime": "2018-11-09T02:00:00Z", "measurements": {"pollutionLevel": 4, "pm25": 77.82705688476562, "airQualityIndex": 85.37593494762073}}], "address": {"country": "Poland", "route": "My\u015bliwska", "streetNumber": "59", "locality": "Krak\u00f3w"}, "latitude": 50.044067, "id": 176, "history": [{"tillDateTime": "2018-11-07T03:59:59Z", "fromDateTime": "2018-11-07T03:00:00Z", "measurements": {"pm1": 74.37672653061225, "pm10": 148.50285714285715, "humidity": 100.0, "pressure": 101868.4747340362, "pollutionLevel": 5, "airQualityIndex": 94.22745454545455, "pm25": 97.30040000000001, "temperature": 1.6026530612244898}}, {"tillDateTime": "2018-11-07T04:59:59Z", "fromDateTime": "2018-11-07T04:00:00Z", "measurements": {"pm1": 46.26191632653062, "pm10": 97.85244897959184, "humidity": 94.75, "pressure": 101868.76677485251, "pollutionLevel": 4, "airQualityIndex": 76.85265769944341, "pm25": 59.07584693877551, "temperature": 2.255765306122449}}, {"tillDateTime": "2018-11-07T05:59:59Z", "fromDateTime": "2018-11-07T05:00:00Z", "measurements": {"pm1": 28.903578723404255, "pm10": 68.72106382978723, "humidity": 97.375, "pressure": 101904.3774348612, "pollutionLevel": 3, "airQualityIndex": 56.460987234042555, "pm25": 36.460987234042555, "temperature": 2.231914893617021}}, {"tillDateTime": "2018-11-07T06:59:59Z", "fromDateTime": "2018-11-07T06:00:00Z", "measurements": {"pm1": 27.546291489361703, "pm10": 63.91404255319149, "humidity": 100.0, "pressure": 101920.78573273354, "pollutionLevel": 3, "airQualityIndex": 54.019719148936176, "pm25": 34.019719148936176, "temperature": 3.1168617021276597}}, {"tillDateTime": "2018-11-07T07:59:59Z", "fromDateTime": "2018-11-07T07:00:00Z", "measurements": {"pm1": 26.696034693877554, "pm10": 62.92, "humidity": 94.75, "pressure": 101939.47922383211, "pollutionLevel": 3, "airQualityIndex": 53.09597142857143, "pm25": 33.09597142857143, "temperature": 4.150867346938775}}, {"tillDateTime": "2018-11-07T08:59:59Z", "fromDateTime": "2018-11-07T08:00:00Z", "measurements": {"pm1": 28.212917021276596, "pm10": 68.41191489361702, "humidity": 94.75, "pressure": 101943.9659454995, "pollutionLevel": 3, "airQualityIndex": 55.83201276595745, "pm25": 35.83201276595745, "temperature": 5.08154255319149}}, {"tillDateTime": "2018-11-07T09:59:59Z", "fromDateTime": "2018-11-07T09:00:00Z", "measurements": {"pm1": 35.3041125, "pm10": 83.75041666666667, "humidity": 92.5, "pressure": 101931.29501464845, "pollutionLevel": 3, "airQualityIndex": 65.53548541666666, "pm25": 45.53548541666667, "temperature": 6.803177083333333}}, {"tillDateTime": "2018-11-07T10:59:59Z", "fromDateTime": "2018-11-07T10:00:00Z", "measurements": {"pm1": 31.315116326530614, "pm10": 76.2077551020408, "humidity": 81.01152897710725, "pressure": 101869.29085648518, "pollutionLevel": 3, "airQualityIndex": 60.3494612244898, "pm25": 40.3494612244898, "temperature": 10.091122448979592}}, {"tillDateTime": "2018-11-07T11:59:59Z", "fromDateTime": "2018-11-07T11:00:00Z", "measurements": {"pm1": 28.182427083333334, "pm10": 67.15041666666666, "pressure": 101825.97876464843, "pm25": 35.17019166666667, "airQualityIndex": 55.17019166666667, "pollutionLevel": 3}}, {"tillDateTime": "2018-11-07T12:59:59Z", "fromDateTime": "2018-11-07T12:00:00Z", "measurements": {"pm1": 27.252310638297875, "pm10": 63.67382978723404, "humidity": 69.30379310324855, "pressure": 101782.35658379737, "pollutionLevel": 3, "airQualityIndex": 53.24098085106383, "pm25": 33.24098085106383, "temperature": 13.868244680851063}}, {"tillDateTime": "2018-11-07T13:59:59Z", "fromDateTime": "2018-11-07T13:00:00Z", "measurements": {"pm1": 24.219978, "pm10": 54.515, "pressure": 101765.78246464842, "pm25": 28.630914000000004, "airQualityIndex": 47.71819000000001, "pollutionLevel": 2}}, {"tillDateTime": "2018-11-07T14:59:59Z", "fromDateTime": "2018-11-07T14:00:00Z", "measurements": {"pm1": 22.85582857142857, "pm10": 51.14244897959184, "pressure": 101779.34187689335, "pm25": 26.16202857142857, "airQualityIndex": 43.60338095238095, "pollutionLevel": 2}}, {"tillDateTime": "2018-11-07T15:59:59Z", "fromDateTime": "2018-11-07T15:00:00Z", "measurements": {"pm1": 26.98080416666667, "pm10": 62.76499999999999, "pressure": 101801.3960563151, "pm25": 32.688439583333334, "airQualityIndex": 52.688439583333334, "pollutionLevel": 3}}, {"tillDateTime": "2018-11-07T16:59:59Z", "fromDateTime": "2018-11-07T16:00:00Z", "measurements": {"pm1": 28.527908510638298, "pm10": 66.98787234042553, "pressure": 101834.36062635058, "pm25": 35.06067021276596, "airQualityIndex": 55.06067021276596, "pollutionLevel": 3}}, {"tillDateTime": "2018-11-07T17:59:59Z", "fromDateTime": "2018-11-07T17:00:00Z", "measurements": {"pm1": 30.357281632653063, "pm10": 70.18163265306123, "pressure": 101844.425958526, "pm25": 37.22428571428571, "airQualityIndex": 57.22428571428571, "pollutionLevel": 3}}, {"tillDateTime": "2018-11-07T18:59:59Z", "fromDateTime": "2018-11-07T18:00:00Z", "measurements": {"pm1": 40.56424285714286, "pm10": 83.87571428571428, "pressure": 101861.1892238321, "pm25": 49.237767346938774, "airQualityIndex": 69.23776734693877, "pollutionLevel": 3}}, {"tillDateTime": "2018-11-07T19:59:59Z", "fromDateTime": "2018-11-07T19:00:00Z", "measurements": {"pm1": 60.851014000000006, "pm10": 117.8218, "pressure": 101881.78666464843, "pm25": 76.52371600000001, "airQualityIndex": 84.78350727272728, "pollutionLevel": 4}}, {"tillDateTime": "2018-11-07T20:59:59Z", "fromDateTime": "2018-11-07T20:00:00Z", "measurements": {"pm1": 80.197324, "pm10": 156.67700000000002, "pressure": 101889.02666464842, "pm25": 103.739216, "airQualityIndex": 97.15418909090909, "pollutionLevel": 5}}, {"tillDateTime": "2018-11-07T21:59:59Z", "fromDateTime": "2018-11-07T21:00:00Z", "measurements": {"pm1": 82.68140000000001, "pm10": 162.82039999999998, "pressure": 101904.37206464844, "pm25": 108.04692800000001, "airQualityIndex": 99.11224, "pollutionLevel": 5}}, {"tillDateTime": "2018-11-07T22:59:59Z", "fromDateTime": "2018-11-07T22:00:00Z", "measurements": {"pm1": 83.77586600000001, "pm10": 164.162, "pressure": 101924.16606464844, "pm25": 109.27948599999999, "airQualityIndex": 99.67249363636363, "pollutionLevel": 5}}, {"tillDateTime": "2018-11-07T23:59:59Z", "fromDateTime": "2018-11-07T23:00:00Z", "measurements": {"pm1": 83.608544, "pm10": 164.5526, "pressure": 101933.13526464844, "pm25": 109.397828, "airQualityIndex": 99.72628545454546, "pollutionLevel": 5}}, {"tillDateTime": "2018-11-08T00:59:59Z", "fromDateTime": "2018-11-08T00:00:00Z", "measurements": {"pm1": 80.657578, "pm10": 158.9538, "pressure": 101936.49646464843, "pm25": 104.991682, "airQualityIndex": 97.72349181818183, "pollutionLevel": 5}}, {"tillDateTime": "2018-11-08T01:59:59Z", "fromDateTime": "2018-11-08T01:00:00Z", "measurements": {"pm1": 80.86108200000001, "pm10": 160.342, "pressure": 101951.05266464845, "pm25": 105.63095000000001, "airQualityIndex": 98.01406818181819, "pollutionLevel": 5}}, {"tillDateTime": "2018-11-08T02:59:59Z", "fromDateTime": "2018-11-08T02:00:00Z", "measurements": {"pm1": 80.52195918367347, "pm10": 158.6869387755102, "pressure": 101972.88106056681, "pm25": 104.9087448979592, "airQualityIndex": 97.685793135436, "pollutionLevel": 5}}]}
#przyklad dostawania sie do danych z jsona
print(data['currentMeasurements']['pressure'])

#poprawne dane sa od 9 pazdziernika 2018
json_list = get_data()



#odwolywanie sie do konkretnego czujnika z konkretnego dnia
print (json_list[0][0].keys())
puste_id = []
for i in json_list:
    iterator = 0
    for j in i:
        if 'currentMeasurements' in j.keys() and not j['currentMeasurements']:
            iterator = iterator+1
            puste_id.append(j['id'])
    print ("tyle id jest puste")
    print (iterator)
print("liczba unikalnych czujnikow ktore byly puste:")
print(len(set(puste_id)))
#ile razy powtarzalo sie id
print("ile mamy plikow:")
print(len(json_list))
print("liczba powtorzen kazdego id")
print(Counter(puste_id))
# for filename in os.listdir(folder): #iteracja po wszystkich plikach w folderze
#      if filename.endswith("txt"):
#          print (filename)
#          with open(filename) as json_file:
#              json_list.append(json.loads(str(json_file)))

print("dokładnosc lat i long")
print (json_list[0][0]['latitude'])
print (json_list[0][0]['longitude'])
print("Program wykonywał się " + str((datetime.now() - startTime).seconds)+ " sekund")